import random

# https://www.codementor.io/@scrapingdog/10-tips-to-avoid-getting-blocked-while-scraping-websites-16papipe62

headers = {
    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9",
    "Accept-Encoding": "gzip, deflate, br",
    "Accept-Language": "en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7",
    "Cache-Control": "max-age=0",
    "Connection": "keep-alive",
    "Host": "movie.douban.com",
    "Referer": "https://www.baidu.com/",
    "Sec-Ch-Ua": "\" Not A;Brand\";v=\"99\", \"Chromium\";v=\"102\", \"Google Chrome\";v=\"102\"",
    "Sec-Ch-Ua-Mobile": "?0",
    "Sec-Ch-Ua-Platform": "\"Windows\"",
    "Sec-Fetch-Dest": "document",
    "Sec-Fetch-Mode": "navigate",
    "Sec-Fetch-Site": "cross-site",
    "Sec-Fetch-User": "?1",
    "Upgrade-Insecure-Requests": "1",
    # fool the server into thinking we're chrome, otherwise will return HTTP 418
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.0.0 Safari/537.36"
}


img_headers = {
    # ':authority': 'img9.doubanio.com',
    # ':method': 'GET',
    # ':path': '/view/photo/s_ratio_poster/public/p1524023814.jpg',
    # ':scheme': 'https',
    'accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9',
    'accept-encoding': 'gzip, deflate, br',
    'accept-language': 'en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7',
    'cache-control': 'no-cache',
    'pragma': 'no-cache',
    'sec-ch-ua': '".Not/A)Brand";v="99", "Google Chrome";v="103", "Chromium";v="103"',
    'sec-ch-ua-mobile': '?0',
    'sec-ch-ua-platform': '"Windows"',
    'sec-fetch-dest': 'document',
    'sec-fetch-mode': 'navigate',
    'sec-fetch-site': 'none',
    'sec-fetch-user': '?1',
    'upgrade-insecure-requests': '1',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36',
}


def get_headers():
    return {
        # "spread operator"
        # **headers,
        # return a random user agent
        "User-Agent": user_agents[random.randrange(0, len(user_agents))]
    }

# http://free-proxy.cz/en/proxylist/country/CN/http/ping/all
# Used to sidestep IP flags. Update as needed
# Thanks to https://stackoverflow.com/a/63095099/10176917

def get_new_proxy():
    return {"http": f"http://{proxies[random.randrange(0, len(proxies))]}"}


proxies = [
    '34.145.226.144:8080',
    '167.235.63.238:3128',
    '50.87.181.51:80',
    '151.181.91.10:80',
    '40.70.172.110:80',
    '58.137.62.133:80',
    '222.214.191.24:9999',
    '80.48.119.28:8080',
    '51.38.191.151:80',
    '185.15.172.212:3128',
    '152.44.40.139:5566',
    '80.179.140.189:80',
    '58.23.212.52:3129',
    '187.217.54.84:80',
    '120.26.14.114:8888',
    '74.208.205.5:80',
    '5.189.184.6:80',
    '169.57.1.85:8123',
    '157.100.26.69:80',
    '67.63.33.7:80',
    '58.23.212.10:3129',
    '43.204.244.135:80',
    '139.198.157.59:7890',
    '152.44.42.188:5566',
    '188.75.64.38:3128',
    '194.233.69.38:443',
    '216.137.184.253:80',
    '151.181.90.10:80',
    '158.69.53.132:5566',
    '151.106.17.123:1080',
    '66.94.120.161:443',
    '43.255.113.232:8084',
    '151.106.17.125:1080',
    '119.13.124.196:59394',
    '38.127.173.47:29602',
    '95.111.243.221:5566',
    '151.106.17.124:1080',
    '151.106.17.126:1080',
    '194.233.69.90:443',
    '145.239.169.40:1080',
    '67.212.186.100:80',
    '151.106.18.126:1080',
    '194.233.69.41:443',
    '103.8.249.97:80',
    '145.239.169.47:1080',
    '158.69.27.94:5566',
    '145.239.169.41:1080',
    '145.239.169.44:1080',
    '67.212.186.102:80',
    '66.94.97.238:443',
    '185.51.10.19:80',
    '27.184.51.17:8089',
    '58.212.197.222:81',
    '185.156.98.69:30400',
    '146.59.83.187:80',
    '194.233.67.98:443',
    '46.127.117.48:3128',
    '201.217.49.2:80',
    '51.79.50.22:9300',
    '51.79.50.31:9300',
    '67.212.186.99:80',
    '194.233.69.126:443',
    '128.199.155.145:3128',
    '200.105.215.18:33630',
    '3.22.79.82:5566',
    '129.213.183.152:80',
    '158.69.71.245:9300',
    '37.18.73.85:5566',
    '173.249.57.9:443',
    '88.1.165.103:3128',
    '198.144.159.40:3128',
    '118.31.1.154:80',
    '151.106.17.122:1080',
    '196.1.95.117:80',
    '85.195.104.71:80',
    '103.68.62.11:80',
    '196.1.97.209:80',
    '159.65.69.186:9300',
    '35.233.16.212:80',
    '74.205.128.200:80',
    '203.77.231.90:9812',
    '123.63.213.137:80',
    '222.92.207.98:40080',
    '218.78.54.149:8901',
    '124.226.194.135:808',
    '87.103.175.250:9812',
    '138.201.108.13:3389',
    '51.91.62.219:80',
    '103.105.212.106:53281',
    '85.70.210.30:80',
    '103.37.141.69:80',
    '51.79.50.46:5566',
    '103.20.204.104:80',
    '133.242.146.103:8000',
    '41.223.136.162:80',
    '05.189.229.42:1081',
    '142.93.223.219:8080',
    '40.117.254.183:80',
    '144.91.123.26:80',
    '118.67.151.29:80',
    '134.122.26.11:80',
    '68.183.185.62:80',
    '200.37.140.37:10101',
    '176.99.2.43:1081',
    '129.213.69.94:80',
]

# https://techblog.willshouse.com/2012/01/03/most-common-user-agents/
user_agents = [
    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.67 Safari/537.36',
    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.0.0 Safari/537.36',
    'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:101.0) Gecko/20100101 Firefox/101.0',
    'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:100.0) Gecko/20100101 Firefox/100.0',
    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.5005.63 Safari/537.36',
    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.64 Safari/537.36',
    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.5005.61 Safari/537.36',
    'Mozilla/5.0 (Windows NT 10.0; rv:91.0) Gecko/20100101 Firefox/91.0',
    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.0.0 Safari/537.36',
    'Mozilla/5.0 (X11; Linux x86_64; rv:100.0) Gecko/20100101 Firefox/100.0',
    'Mozilla/5.0 (X11; Linux x86_64; rv:101.0) Gecko/20100101 Firefox/101.0',
    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.5 Safari/605.1.15',
    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.5005.61 Safari/537.36',
    'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.5005.61 Safari/537.36',
    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.4 Safari/605.1.15',
    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.54 Safari/537.36',
    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:100.0) Gecko/20100101 Firefox/100.0',
    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.64 Safari/537.36 Edg/101.0.1210.53',
    'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:100.0) Gecko/20100101 Firefox/100.0',
    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.0.0 Safari/537.36',
    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:101.0) Gecko/20100101 Firefox/101.0',
    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.5005.62 Safari/537.36',
]
